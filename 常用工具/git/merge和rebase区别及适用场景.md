## 一、merge



## 二、rebase

### rebase黄金法则

**法则：**

> 绝不要在公共的分支上使用它！

在你运行 git rebase 之前，一定要问问你自己「有没有别人正在这个分支上工作？」。如果答案是肯定的，那就不能rebase



### rebase的优点和缺点
**优点**

- rebase最大的好处是你的项目历史会非常整洁
- rebase 导致最后的项目历史呈现出完美的线性——你可以从项目终点到起点浏览而不需要任何的 fork。这让你更容易使用 git log、git bisect 和 gitk 来查看项目历史

**缺点**

- 安全性，如果你违反了 rebase 黄金法则，重写项目历史可能会给你的协作工作流带来灾难性的影响
- 可跟踪性，rebase 不会有合并提交中附带的信息——你看不到 feature 分支中并入了上游的哪些更改







 `git pull` 这条命令默认使用了 `--merge` 的方式更新代码，如果你不指定用 `--rebase` 



1. 更新当前分支代码的时候一定要使用 `git pull origin xxx --rebase`
2. 合并代码的时候按照最新分支优先合并为原则
3. 要经常从上游分支更新代码，如果长时间不更新上游分支代码容易出现大量冲突





## 三、区别

1. 用merge确实只需要解决一遍冲突，比较简单粗暴
2. 用rebase有时候会需要多次fix冲突（原因在于本地分支已经提交了非常多的commit，而且很久都没有和上游合并过） 
3.  merge 会存在合并的历史记录，而rebase没有了历史记录且成一条直线。 

### Merge

- 简单易理解
- 源分支和目标分支相互分离
- 保留功能分支的提交历史和分支图形
- 分支一旦较多显示比较混乱

### Rebase

- 简化复杂的记录且线性可读
- 没有合并的记录
- 多个commit冲突时必须一个个提交去修改
- 对远程分支rebase需要force push

## 四、使用场景

> merge:直接依次合并。
>
> rebase:按当时的步骤进行重做。
>
> 总结：合并分支时，一定要先更新到最新，然后再进行合并操作。



- 独立开发

  如果你不是团队合作开发，那么你可以优先选择使用rebase来保持你整洁的提交历史。

- 准备code review

  你需要在合并的时候有人来给你review，此时你需要提交一个 merge/pull request,此时别人可review你的代码后会执行merge，这将保存你此次的请求合并的记录，已备将来追溯。

- 合并到多个目标分支或其他人正在使用当前分支

  这是应该使用merge,因为你执行rebase时,当前分支原先的commit会被删除（会影响他人），形成新的commit连接在目标分支最新commit之后。所以在这个条件不成立的时候你可以使用rebase来合并分支。